\chapter{Results}

Performing optimal control of quantum many-body systems is typically extremely resource demanding \cite{Mennemann2015}. Hence, previous studies of optimization of Bose-Hubbard dynamics have abstained from using gradient-based techniques and instead opted for the gradient-free Nelder-Mead method combined with control parameterizations \cite{Doria2011,FrankBloch}. The framework presented in this thesis combines tensor description of lattice systems with parameterized optimal control methods and highly-developed gradient-based algorithms from mathematical optimization theory. Here, the framework is used for optimizing the ramp sequence for transitioning from a superfluid to a Mott-Insulator in a Bose-Hubbard system, however, the method can easily be extended to any system in a one-dimensional lattice.
Although the individual components of the framework are described in previous chapters, a summary of their unification is brought here:

The physical quantum system is represented using Matrix Product States described in Chapter \ref{chap:MPS}. Through the many Schmidt decompositions used for creating and modifying the tensor networks weakly contributing eigenstates are discarded, whereby one avoids the otherwise exponential scaling of the numerical representation with physical size of the system. For the purposes of this thesis, the ITensor library \cite{ITensor} has proven itself very useful for tensor-operations.
To simulate the dynamics of the system, a modified version of the tDMRG algorithm described in Section \ref{sec:modTMDRG} is employed. The algorithm efficiently time-evolves the tensor network states while maintaining an accurate description of the system.
In order to address the crossing of the phase transition in the Bose-Hubbard model, the state transfer is formulated as the minimization of a cost function \eqref{eq:grapeCost} through the optimal control framework of Chapter \ref{chap:OptimalControl}. The GRAPE method supplies derivatives of the cost function with respect to the control parameters \eqref{eq:STcostgrad}, whereby the optimization problem can be solved using gradient-based techniques. Further extensions are added through GROUP, which parametrizes the control through smooth functions \eqref{eq:controlParametrization} thereby reducing the dimension of the optimization space.
Due to limits of the physical model, the control problem is subjected to a series of constraints, which makes the optimization very difficult. 
Interior Point methods are considered some of the most powerful algorithms for solving non-linear, constrained problems. Using the gradient of the cost function, the algorithm approaches the optimal control values from within the feasible region. Thus, interior point methods require fewer, but more expensive, steps to converge, which is a beneficial feature when using the computationally expensive GRAPE gradient. The version of the Interior Point method used here is implemented in IPOPT library \cite{Wachter2006}.\\

In this chapter the performance and accuracy of the framework is analyzed. First, suitable optimization settings and boundary conditions are discussed.
Next, the framework is applied to a small Bose-Hubbard system of five sites and five particles, and its performance is compared to optimizations performed using the Nelder-Mead method.
Finally, the application of the framework on larger systems is discussed, and an analysis of the entanglement entropy during quenches past the critical point is made. 


\section{Determining Parameters}

As previously discussed in section \ref{sec:modTMDRG} the phase of Bose-Hubbard model is solely determined by the fraction $U/J$. Expressing the parameters in units of $J$, causes the tunneling part of the Hamiltonian to act as a drift, while the interaction matrix element, $U$, serves as the control function.\\
The time evolution is carried out using Suzuki-Trotter decomposed propagator, where the Trotter step has been chosen as $\Delta t = 10^{-2}$. The Trotter step is larger than in other studies \cite{Doria2011,FrankBloch,Braun2015}, however, any smaller step-size would result in numerical costs outside the scope of this thesis.


\subsection{Boundary Conditions and Constraints}
The Bose-Hubbard model is only well defined within the tight-binding limit. Below this limit the Wannier functions may start overlapping with the next-nearest neighbouring sites thereby facilitating two-site hopping, which is not accounted for in the model. Thus, the control function must be subjected to a lower boundary. In \cite{FrankBloch,Doria2011} initial lattice depths at $V_0 (0) = 3 E_{\mathrm{rec}}$ and $2 E_{\mathrm{rec}}$ were chosen, where it was argued that the model is still a decent approximation at this depth.
Taking a conservative approach, the control here is subjected to the constraint $U (t) \geq 2 J$, which corresponds to a lattice depth around three recoil energies for a gas of Rb-87 atoms and an optical lattice with wavelength $\lambda = 1064 \: \mathrm{nm}$. 
The initial control value was set slightly above the minimum value at $U (0) = 2.5 J$. Initially, the first control value was chosen to be equal to the lower bound, however, initiating the interior point algorithm at the edge of the feasible region caused to method to exhibit a poor convergence rate during its initial cycles.
The final control value was set to $U (T) = 50 J$, which roughly corresponds to the final lattice depth of $V_0 (T) = 14 E_{\mathrm{rec}}$ used in \cite{FrankBloch}.\\
The initial and target state were calculated from the control parameter at the start and end of the duration respectively using the DMRG algorithm. Thus, the states are insured to be the ground state at each end of the duration, whereby the optimized state transfer will bring be between two ground states.


\subsection{Seed Selection}
The success of an optimization process is often dependent on the quality of the initial starting point or seed. Poor seeding strategies can lead to failure in finding optimal solutions when conducting local searches in complex optimization landscapes \cite{Sorensen2016}. This has been demonstrated to occur in constrained quantum control problems \cite{Zhdanov2015}. Hence, the type of seed used for the optimization must be chosen carefully.\\ 
Different adiabatic lattice ramps from the superfluid to Mott-Insulator phase were examined in \cite{Zakrzewski2009}. The study concluded that ramping the lattice slowly around the point of the phase transition results in an improved final fidelity, which is very similar to the process of sweeping over an avoided crossing \cite{manybodyBloch}.\\
Therefore, a ramp sequence was proposed in \cite{Zakrzewski2009}, which has an initial sigmoid shape followed by a slow increase in the lattice depth around the phase transition point. Following this, the lattice follows an exponential ramp to its final depth. Examining other attempts of optimizing the ramp sequence of the Bose-Hubbard model \cite{Doria2011,FrankBloch} shows similar traits in their results. Therefore, choosing seeds with a slow ramp across the point of the phase transition followed by a rapid increase in lattice depth should yield good optimization results.
\begin{figure}[h!]
    \centering
    \includegraphics[width=0.7\textwidth]{Figures/LinSigSeed.pdf}
    \caption{\textit{Distribution of seeds used for optimization. All seeds lie within the lightly shaded region, while the darker region contains the 25-75 percentile of seeds. Lastly, the dotted line is the median value of the seed. The dashed line signifies the point of the Bose-Hubbard phase transition.}}
    \label{fig:LinSigSeed}
\end{figure}
Figure \ref{fig:LinSigSeed} shows the distribution of seeds used for the optimizations. Due to control parameter being the interaction strength of the Bose-Hubbard model, the phase transition occurs at quite a low control value. Hence, the initial part of the seed is a slowly increasing linear ramp, which crosses the point of the phase transition with a small slope. A shape function has been multiplied to the seeds enforcing a horizontal slope at the start and end of the duration, which helps avoiding any kinks in the control curve.



\section{Characterization of Methods on a Small System} \label{sec:5partOptimization}
To determine suitable settings for the optimization, an initial analysis of a small system consisting of 5 sites with unit occupancy was made. Systems of different sizes are expected to evolve differently, especially due to the closed boundary conditions of the lattice, which have a greater impact for smaller systems. Although the dynamics are expected to vary with the lattice length, certain parameters can be optimized in a smaller system. The regularization factor, $\gamma$, and the dimension of the chopped basis, $M$, only affect the shape of the control pulse, which is subjected to constraints independent of the system size.\\
Due to the small size of the system, no maximum bond dimension was required. Instead, a truncation threshold of $\epsilon_t = 10^{-8}$ was used. Furthermore, the relative tolerance used by the IPOPT library for determining convergence was set at a very low $1e-8$. 

\subsection{Determining the Quantum Speed Limit}
To illustrate the the achieved fidelity's dependence on duration of the control sequence, a series of optimizations were made while scanning over the duration $T$. For this a regularization factor of $\gamma = 10^{-6}$ and an optimization space dimension of $M = 20$ were used. Since the control is parametrized using a linear combination of smooth functions, the effect of the regularization term is limited. Nevertheless, it does help the optimization algorithm avoid greatly varying controls during its initial iterations.\\
Figure \ref{fig:FidelityDuration5} shows the final fidelities obtained for various durations from 100 different initial controls.
\begin{figure}[h!]
    \centering
    \includegraphics[width=0.9\textwidth]{Figures/L5/FidelityDuration.pdf}
    \caption{\textit{Final fidelity obtained for optimal control at various durations. \textbf{(a)} the dotted line marks the median fidelity achieved, while the shaded area displays the $25\%$- and $75\%$-quartiles of the solutions. \textbf{(b)} the lowest infidelity achieved for each duration. }}
    \label{fig:FidelityDuration5}
\end{figure}
In part \ref{fig:FidelityDuration5}(a) the $25\%$- and $75\%$-quartiles along with the median of the solutions are displayed. At short durations the system can not evolve fast enough from the initial state to reach the target state, hence only low fidelities are obtained. However, as more and more time becomes available, fidelities very close to unit can be reached. Although the final fidelity does not appear to improve beyond $T=3$, figure \ref{fig:FidelityDuration5}(b) reveals the best solutions still improving at longer durations albeit at a reduced rate.\\
Compared to other figures of merit, the fidelity is a very strong measure, as it only considers the overlap with the target state. Due to the large number of quantum states in lattice systems, achieving unit fidelity is practically impossible, and even reaching high fidelities become increasingly difficult with system size. An alternative figure of merit was used for the optimal control of a Bose-Hubbard system presented in \cite{FrankBloch}. Instead of determining the convergence through the infidelity, a rescaled variance of the particle numbers in each of the central sites was used. This figure of merit is much less sensitive to the system size, however, it does have some less favorable properties: First, multiple particle configurations different from unit occupancy of each site can achieve a vanishing particle number variance. Furthermore, the pure state of a single particle on each lattice site only becomes the ground state as the lattice depth tends towards infinity. Therefore, the figure of merit used in \cite{FrankBloch} does not steer the state towards the ground state at the final control value, which could result in residual oscillations of the system after the control sequence. It should be noted that at the final control value used here, the state with a single particle at each site is a very good approximation of the ground state.
Nevertheless, the fidelity is a more direct figure of merit, as it steers the system towards a single, well defined state.\\
Obtaining unit fidelity in a complex quantum system is very difficult, whereby a threshold for accepted final fidelity must be agreed on in order to determine the quantum speed limit. The threshold must be variable with the systems size, due to the sensitivity of the fidelity. In \cite{MajaJulie} a similar optimization was made, and an infidelity threshold of $I_{\mathrm{QSL}} = 10^{-3}$ was set for a 3-site lattice. Adopting the same threshold for the results shown in figure \ref{fig:FidelityDuration5} yields a quantum speed limit of $T_{\mathrm{QSL}}^{(5)} = 2.7$ for the 5-site lattice.\\

Further information regarding the control landscape and the consistency of the algorithm can be inferred from the spread in fidelities shown in figure \ref{fig:FidelityDuration5}.a. A large variety of final fidelities may be due to a control landscape with many local minima. On the other hand, the same phenomenon could be caused by the inability of an algorithm to accurately converge to the minimum. The interior point method is a very robust algorithm capable of handling non-linear constraints, whereby it is reasonable to assume the variations in solutions being caused by the underlying control landscape. Considering the fairly large variation in seeds shown in figure \ref{fig:LinSigSeed}, the control landscape of the 5-site problem must be relatively simple, as the variation in obtained fidelity is rather small.


\subsection{Convergence Rate}

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.9\textwidth]{Figures/L5/CostProgress.pdf}
    \caption{Hej}
    \label{fig:CostProgress}
\end{figure}

\subsection{Optimized Ramp Sequences}

KIBBLE-ZUREK NUMBER FLUCTUATIONS!

A central question is how the optimized ramp sequence differs from its initial seed in both shape and fidelity reached. From figure \ref{fig:FidelityDuration5} one observes that durations around $T = 2.5$ consistently produce solutions with very high fidelity. The lowest infidelities reached at this duration are around $I \approx 10^{-3}$. 
\begin{figure}[h!]
    \centering
    \includegraphics[width=0.9\textwidth]{Figures/L5/RampPlot.pdf}
    \caption{\textit{Solution with highest fidelity achieved for duration $T = 2.5$. The dashed, red line marks the end of the duration, from which the system is further evolved using the final control value. \textbf{(a)} logarithmically scaled expectation value of the number operator, $\braket{\hat{n}_i}$, for each site as the system is evolved according to the optimized ramp. \textbf{(b)} the initial and optimized ramp sequences along with the corresponding evolution of fidelities.}}
    \label{fig:ExtendedRamp5}
\end{figure}
Figure \ref{fig:ExtendedRamp5} displays an optimized ramp sequence at duration $T = 2.5$ along with an illustration of the evolution of the system. First, consider part \ref{fig:ExtendedRamp5}(b) in which the initial and optimized control is plotted together with the resulting infidelity. Optimizing the initial seed utilizing the GROUP algorithm has resulted in an increase of two magnitudes in the final fidelity achieved.
While the initial ramp is fairly smooth, the optimized ramp wiggles a bit during the first half of the duration followed by a sharp upswing towards the final control value. The steep increase in the control towards the end is very similar to the adiabatic ramp sequence proposed in \cite{Zakrzewski2009}, however, the initial oscillating behavior is non-adiabatic. In fact, examining the optimized ramp sequences for durations shorter than $T = 2.5$ shows an increase in the amplitude of the ramp oscillations, as solutions are required to be increasingly non-adiabatic in order to reach a good fidelity within the given duration. Meanwhile, solutions for durations longer than $T = 2.5$ become increasingly adiabatic-like.\\
After the given optimization duration, $T$, the final control value is kept constant for an additional time span, where the system is further evolved. Any residual evolution of the system at this point is due to the system not being an eigenstate of the Hamiltonian corresponding to final control value. When examining the initial and final ramp sequence after the optimization duration, the initial control appears to reach a more stable state. However, this is an illusion caused by the logarithmic axis, as the optimized ramp produces a state much closer to the target state, which is set as the ground state of $\hat{H}(U(T))$ through the DMRG algorithm.\\ 
Figure \ref{fig:ExtendedRamp5}(a) illustrates the expectation value of the number operator, $\braket{\hat{n}_i}$, for each site during the ramp. Initially the system is in the superfluid state causing a low energetic cost for having multiple particles on each site. Thus, one observes a reduced number of particles at the outer sites of the lattice due to the closed boundary conditions. As the system is evolved towards the Mott-Insulating state, having multiple particles at the same sites becomes very energetically unfavorable. Hence, the target state has a single particle at each site, as it is deep in the Mott regime. The optimized ramp brings the system very close to this configuration of particles, which can be observed near the dashed red line marking the end of the duration, $T$. Some imperfections are present, although their magnitude is exaggerated by the logarithmic color axis. The residual oscillations of the infidelity after the optimization durations can be seen in figure \ref{fig:ExtendedRamp5}(a) as fluctuations of the particle number. 


\subsection{Control Basis Size}
Unlike GRAPE, which takes the full optimization space into account, parameterizations like GROUP utilize a chopped basis resulting in a much smaller dimension of the optimization space. When reducing the dimension of the optimization space through a parametrization as described in eq. \eqref{eq:controlParametrization}, the new control basis must be able to span the solution space. Otherwise artificial minima can be introduced to the control landscape due to the incompleteness of the basis \cite{Rach2015}. 
In the implementation of GROUP used for these calculations, the basis functions of the chopped basis are of the form $f_n = \sin \left( \omega_n t / T \right)$, where $\omega_n = n \pi$.
To investigate the basis size required to describe the optimal solutions, a series of optimizations were made for various basis sizes at the duration $T = 2.5$. 
\begin{figure}[h!]
    \centering
    \includegraphics[width=0.9\textwidth]{Figures/L5/FidelityBasisSize.pdf}
    \caption{\textit{Final fidelity obtained for optimal control at various optimization space dimensions for duration $T = 2.5$. \textbf{(a)} the dotted line marks the median fidelity achieved, while the shaded area displays the $25\%$- and $75\%$-quartiles of the solutions. \textbf{(b)} the lowest infidelities achieved for each basis size.}}
    \label{fig:FidelityBasisSize5}
\end{figure}
The results of the scan over the basis size can be seen in figure \ref{fig:FidelityBasisSize5}. From figure \ref{fig:FidelityBasisSize5}(a) it is evident that a basis size of around 20 and above consistently produces high-fidelity solutions, while the quality of solutions using a smaller basis size fluctuated greatly. Thus, high-fidelity ramps for $T = 2.5$ have at least 20 frequency components. Although results obtained with a smaller basis are generally worse, high fidelity solutions are still possible to achieve, as the optimal solution may still be realizable using only few frequencies. This can be observed in figure \ref{fig:FidelityBasisSize5}(b), where the infidelity of the best solution remains constant, while the median fidelity of the solutions decreases. The large spread in final fidelity is a consequence of a more complicated optimization landscape with artificial minima.


\section{Application on Larger Systems} \label{sec:appLargeSystems}

The framework already contains all the components required for applications on larger systems, however, in larger the systems the effects of the open boundaries of the lattice is much smaller, whereby a much higher entanglement entropy is expected. Therefore, optimization of larger systems is infeasible employing the very low degree of truncation used for the smaller system. 

When applying the same settings to a system of 15 sites the optimization became increasingly slow for longer durations. Since no maximum bond dimension was specified, the matrices of the tensor network continued to grow in size, as entanglement built up in the system following the phase transition. As the cost of applying the tDMRG propagator scales quadratically with the bond dimension of the state, the time-evolution became increasingly slow. Furthermore, the GRAPE algorithm stores the state at each time step to efficiently compute the gradient, which causes the program to run out of available memory in certain cases. Thus, an analysis of the growth of entanglement within the system is necessary, if the framework is to be applied to larger systems.\\

Further improvements to the convergence rate may be achieved by calculating the Hessian of the cost function. For the purpose of this thesis, the Hessian was approximate using the L-BFGS algorithm, however, this approximation only becomes sufficiently accurate after multiple iterations. Since interior point methods solve a series of subproblems for decreasing barrier heights, the L-BFGS approximation must be restarted multiple times thus reducing its effectiveness \cite{Wachter2006}. On the other hand, supplying interior point methods with analytically derived gradient should result in superlinear convergence \cite{wright}.

A full derivation of the general GRAPE Hessian is presented in Appendix \ref{chap:Hessian} along with the altered version for the Suzuki-Trotter propagator. If both the forward propagated initial state and the backwards propagated target state is kept at each time step, the computation of the Hessian requires an additional $N(N - 1)/2$ step propagations, where $N$ is the total number of time steps of the ramp duration. However, these propagations can be separated into $N$ parallel calculations, which should significantly reduce the computational time of the Hessian. Note, that storing the backwards propagated target state would result in a doubling of the required memory occupied by the algorithm. Therefore, a suitable truncation of the tensor bond dimensions is required for the implementation of the Hessian.

In addition to increasing the convergence rate, valuable information regarding the optimization landscape can be extracted from the Hessian \cite{Shen2006}. Therefore, the addition of the Hessian to the framework may be a necessary step towards application on large systems, however, its implementation is outside the scope of this thesis.


\subsection{Spreading of Correlations and Entanglement}
Truncations of the matrix product state are necessary when optimizing control sequences for large systems, however, the truncation effectively creates a low-entanglement representation of the system. Hence, understanding the growth of entanglement within the system is crucial for the application on larger system. Furthermore, correlations within the system are essential to characterizing the system, whereby studying their evolution versus that of the entanglement entropy will provide valuable insight into the underlying dynamics of the system.

For this study a Bose-Hubbard system of 20 sites and particles was chosen. In a 20-site system, the overall effects of the open boundaries are much smaller, whereby the dynamics in this system are comparable to those of even larger lattices.
Previous studies have shown that the ramping speed greatly affects the dynamics of the system \cite{Lauchli2008,Braun2015}. Therefore, two very different ramps from $U(0) = 2.5 J$ to $U(T) = 50 J$ were examined: An abrupt quench to the final vale, and an exponential ramp typical from experimental procedures. Both ramps lasted a duration of $T = 3 J^{-1}$ and utilized Trotter steps of size $\Delta t = 5 \cdot 10^{-3} J^{-1}$. Furthermore, the maximum occupation at a single sites was limited to 7 bosons, which is relatively high and therefore should not affect the results \cite{Braun2015}. The analysis was carried out using a high truncation threshold of $\epsilon_t = 10^{-8}$ and a maximum bond dimension of $D = 1000$, whereby the entropy was barely limited.\\
\begin{figure}[h!]
    \centering
    \includegraphics[width=\textwidth]{Figures/L20/EntanglementGrowth.pdf}
    \caption{Dynamical evolution of entanglement entropy and correlations during different types of ramps from $U(0) = 2.5 J$ to $U(T) = 50 J$. \textbf{(a-b)} von-Neumann entropy \eqref{eq:vNEntropy} for bipartitions of the lattice at various bonds, with bond 1 being between lattice sites 1 and 2 and so on. \textbf{(c-d)} Single-particle correlations for different distances $r$. \textbf{(e-f)} Rescaled density-density correlations for different distances $r$.}
    \label{fig:EntanglementGrowth}
\end{figure}

Figures \ref{fig:EntanglementGrowth}(a-b) display the von-Neumann entropy \eqref{eq:vNEntropy} for bipartitions of the lattice at different bonds.
In the case of the exponential ramp, the entanglement entropy between approximately equal sized blocks of the lattice remains almost constant throughout the entire duration. In fact, the entropy across the outer bonds decreases a relatively large amount. Near a critical point, the correlation length and entanglement should diverge for an equilibrium state \cite{Zurek2005}. However, since the system crosses the phase transition dynamically, the ground state decays into a linear combination of excited states, whereby the divergent behavior of the entropy is avoided. Since the exponential ramp is rather slow, it can be considered adiabatic for parts of the duration, whereby no excitations and entanglement is generated. For such a ramp, the dynamics will be influenced by the Kibble-Zurek mechanism \cite{Braun2015}.

On the contrary, the sudden quench in the interaction strength causes a rapid increase of entanglement. Quench dynamics are limited by the Lieb-Robinson bounds \eqref{eq:LiebRobinsonBound}, which is apparent from linear increase in entanglement with slope independent of the block size, $l$.  The saturation value of the entropy depends linearly on the block size, which effectively defines a maximum entropy propagation velocity $v_e$. A linear growth of entropy up to times $t = l/2 v_e$ has been shown for different models \cite{Lauchli2008,Eisert2006,Amico2008,Calabrese2005}, confirming that the spreading velocity is limited by a universal bound. A similar study the Bose-Hubbard model on a 32-site lattice \cite{Lauchli2008} yielded very similar results, whereby the dynamics appear relatively independent of system size.
Thus, the quantum state during a slow ramp can be accurately represented using only a small bond dimension. Meanwhile, a high bond dimension is required to fully describe the rapidly increasing entropy during a fast ramp sequence. \\

Next, the single-particle correlations, $\braket{\hat{a}_{0}^{\dag} \hat{a}_{r}}(t)$, during the two ramps were examined. For comparison it is worth looking at the equilibrium correlations and density matrices previously shown in figure \ref{fig:DensityMatrices}. In equilibrium one observes very long-ranged correlations in the superfluid phase, while the correlations decay exponentially for the Mott-insulation state. Figures \ref{fig:EntanglementGrowth}(c-d) display the single-particle correlations during the ramp sequence for various distances, $r$, from a reference site. Here, the 7th site of the lattice was chosen as reference to avoid the effects of the boundaries of the lattice.
Considering the exponential ramp first, the correlations decrease for the first half of the duration followed by a series of damped oscillations. Around the critical point, the Kibble-Zurek mechanism suggests a decay of correlation length following a power law \cite{Zurek2005}. While this is not entirely obvious from figure \ref{fig:EntanglementGrowth}(c), the correlation length clearly decreases during the first third of the duration, after which it starts growing again. The second half of the sweep duration features large oscillations in the correlations. The Kibble-Zurek mechanism is responsible for freezing in fluctuations, although the superfluid to Mott-transition should predominantly feature number fluctuation. A study of the phase transition via an exponential ramp showed that one would observe Gaussian damped revivals of the phase coherence \cite{Schutzhold2006}. The Gaussian decay should be independent of the distance $r$, which appears to be the case in figure \ref{fig:EntanglementGrowth}(c), as the fluctuations decay relatively similar.

Compared to the exponential ramp, the single-particle correlations behave much more violently, when the system is quenched. Initially, the correlations oscillate with a period of $T_{osc} \approx 2 \pi / U(T)$. These oscillations originate from the spectrum of the interaction part of the Bose-Hubbard Hamiltonian. Consider the case of negligible tunneling, whereby the evolution of the single-particle correlations is
\begin{equation}
	\braket{\hat{a}_{i}^{\dag} \hat{a}_{j}}(t) = \sum_{ \{ n \} , \{ n' \}} c_{n}^{*} c_{n'} \Braket{ \{ n \} | \hat{a}_{i}^{\dag} \hat{a}_{j} | \{ n' \}} \; \delta_{n_i , n_{i}' +1} \; \delta_{n_j , n_{j}' -1} \; e^{i U(T) (n_j ' - n_i ' - 1) t} \; ,
	\label{eq:CorrelationEvolution}
\end{equation}
where $\{ n \}$ is the set of Fock states with $n_i$ particles on the $i$'th site, and $c_n$ are coefficients of a general state \cite{Lauchli2008}. Only Fock state pairs corresponding to a particle begin annihilated at site $j$ and created at site $i$ will contribute to $\Braket{ \{ n \} | \hat{a}_{i}^{\dag} \hat{a}_{j} | \{ n' \}}$. As a result, the frequencies of the time evolution are given by $U(T) (n_j ' - n_i ' - 1)$. For a Mott-insulator with unit occupation all sites are populated equally, whereby the corresponding frequency is $-U(T)$ yielding an oscillation period $T_{osc} = 2 \pi / U(T)$. However, when starting in a superfluid state, the number fluctuations will result in frequencies containing higher multiplies of $U(f)$. Thus, the amplitude of higher-order frequencies is determined by the starting value $U(0)$.
In this case, the initial value is rather close to the critical point, whereby higher-order frequencies are not apparent until the first-order frequency has decayed sufficiently. At $t \approx 0.5 J^{-1}$ a beat-like structure in the oscillations is visible signifying contributions from higher-order frequencies. 
The single-particle correlation evolution \eqref{eq:CorrelationEvolution} assumes a vanishing tunneling. However, any finite tunneling will cause a spread in the frequencies, which ultimately leads to the decay of the oscillations in time \cite{Kollath2007}. Such decaying revivals have been observed experimentally in a Bose-Hubbard system \cite{Greiner2002collapse}.

After the relaxation of the oscillations, the system reaches a quasi-steady state with only minor fluctuations. These residual fluctuation in the correlations can be interpreted as number fluctuations of the superfluid being "frozen in" during the quench. As these number-fluctuations may be long-lived \cite{Schutzhold2006}, the residual oscillations remain for longer times. 

Clearly, neither the exponential ramp nor the quench produces an equilibrium Mott-insulator, as the final state has large, oscillating correlation functions. Nevertheless, while not being a Mott-insulator, the quenched system reaches a quasi-steady state. An investigation of the problem in \cite{Kollath2007} revealed that the steady-state correlation lengths were determined mainly by the difference between the initial and quenched value of $U$. Thus, the final state could be categorized as belonging to one of two non-equilibrium phases: A \textit{non-thermal steady state} produced by a large quench, and a \textit{thermalized state} for smaller quenches. The state obtained here is distinctly non-thermal, as it retains a strong memory of its initial state.\\

Finally, the evolution of density-density correlations, $\braket{\hat{n}_{0}^{\dag} \hat{n}_{r}}(t)$, was investigated, as shown in figures \ref{fig:EntanglementGrowth}(e-f). Since the number operator, $\hat{n}_i$, commute with the interaction term of the Bose-Hubbard Hamiltonian, no large oscillations should be present in the strong coupling limit. For the case of the exponential ramp this is indeed the case, as the correlations at all distances decay towards the same constant value associated with equal population across the lattice. For a perfect Mott-insulator and unit occupancy the density-density correlations should converge to 1. However, as established earlier, the exponential ramp clearly does not produce the ground state Mott-insulator, whereby the deviations are expected. Interestingly, small oscillations in the correlations are present at later times for all distances. This is most likely caused by the superfluid number-fluctuations frozen in by the Kibble-Zurek mechanism.

When quenching the system, the density-density correlations behave much differently. Due to rapid change of the interactions, the correlations can no longer relax into a common value but are instead almost frozen in from the start. At short distances, the correlations appear increasingly Mott-like, while at longer ranges the large variances in population becomes apparent. Further examining the first half of the quench duration, it is clear that some signal is propagating through the system at what appears to be a constant velocity.
\begin{figure}[h!]
    \centering
    \includegraphics[width=0.8\textwidth]{Figures/L20/CorrelationLightCone.pdf}
    \caption{Time evolution of normalized density-density correlations $\braket{\hat{n}_{0}^{\dag} \hat{n}_{r}}(t) / \braket{\hat{n}_{0}^{\dag} \hat{n}_{r}}(0)$ after an abrupt quench. The correlations are spreading with a constant velocity, and the front of the evolution is marked by a dashed line.}
    \label{fig:CorrelationLightCone}
\end{figure}
Plotting the evolution of the density-density correlations as a function of distance produces figure \ref{fig:CorrelationLightCone}, where the light-cone-like propagation of correlations is very obvious. For distances $r >  v_c t$, with $v_c$ being the propagation velocity of correlation, the correlations are constant, despite the system having already undergone the quench. In the limit of very fast ramps (where a quench is instantaneous), the propagation of correlations can be interpreted as ballistically spreading quasi-particles \cite{Cheneau2012,Calabrese2006}. The propagation velocity of the correlations is bounded by the Lieb-Robinson bound \ref{eq:LiebRobinsonBound}, resulting in the effective light-cone. An even clearer light-cone was shown in \cite{Lauchli2008} by rescaling the correlations accordingly.\\

The exponential ramp and the quench represent two limits of ramping speeds. The exponential ramp is slow, whereby the system can react almost adiabatically, as no violent oscillations in the correlations are present. Nevertheless, the product of exponential ramp is clearly not a perfect Mott-insulator, as correlation functions point towards number fluctuations in the final state. However, since the entanglement entropy of the system does not increase during the ramp, the matrix product description of the state is very accurate at even long timescales.
On the other hand, the dynamics of the correlations following a quench are much more violent, as the ramp is essentially instantaneous. At long timescales, the system starts to reach a steady-state, although this state appears non-thermal from its correlations, whereby it has very different characteristics than the Mott. An optimal ramp will most likely contain elements from both fast and slow ramps in order to produce a high-fidelity Mott-insulator at a low ramp duration. 



\subsection{Required Bond Dimension for Non-Equilibrium Dynamics}
The main limiting factor when performing quantum optimal control is the computational cost of the time-evolution. Thus, for large systems it is vital to maintain a minimal bond dimension during the entire ramp duration. The previous analysis illustrated the dynamics of a 20 site system with unit occupation during a fast and a slow ramp. Here, the effect of truncating the tensors at various maximum bond dimension is investigated. As an exponential ramp causes no increase in the entanglement entropy of the system, the system should be much easier to simulate. Therefore, it is of interest just how few contributing eigenstates need to kept in order to produce a final state comparable to a non-truncated one.
For this analysis, an even slower, $T = 5 J^{-1}$, exponential ramp was used. The truncation threshold was kept at $\epsilon_t = 10^{-8}$, while the maximum bond dimension was varied. The calculation was carried out for Trotter step-sizes of $\Delta t = 5 \cdot 10^{-3} J^{-1}$ and $\Delta t = 10^{-2} J^{-1}$ and produced similar results. Here the results for a step size of $\Delta t = 10^{-2} J^{-1}$ are shown, as this step size is more likely to be used for the optimization of a larger system.\\ 

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.9\textwidth]{Figures/L20/BondDimEvolution.pdf}
    \caption{ Evolution of bond dimensions during an exponential ramp. \textbf{(a)} The exponential ramp from $U(0) = 2.5 J$ to $U(T) = 50 J$. The crossing of the critical point is marked by the dashed line. \textbf{(b)} Dimension of various bonds of the matrix product representation of the quantum state. }
    \label{fig:BondDimEvolution}
\end{figure}
First, the growth of bond dimension during the ramp was investigated, which is shown in figure \ref{fig:BondDimEvolution}. In subfigure (a) the exponential ramp is shown, and the time at which it crosses the critical point is marked by a dashed line. The bond dimensions of the initial superfluid state evolved according to the ramp is displayed in figure \ref{fig:BondDimEvolution}(b). Initially, the bond dimension remains constant, which is expected from the previous results showing the entanglement entropy decreasing during the ramp duration. However, a short while after having crossed the critical point, the dimension of all inner bonds starts increasingly rapidly. This increase in bond dimension is very similar to the increase in entropy following a sudden quench, however, it is most unexpected in the case of the exponential ramp. Although the bond dimension of a matrix product state is expected to increase as it is time evolved \cite{Daley2004}, the truncation threshold of $\epsilon_t = 10^{-8}$ should maintain a low bond dimension throughout the duration.
\begin{figure}[h!]
    \centering
    \includegraphics[width=0.9\textwidth]{Figures/L20/InitialBondDim.pdf}
    \caption{ Bond dimensions of the initial superfluid ground state for $U = 2.5 J $ and the target Mott-insulating ground state for $U = 50 J $.}
    \label{fig:InitialBondDim}
\end{figure}
For comparison, the bond dimensions of the initial and target states are illustrated in figure \ref{fig:InitialBondDim}. The superfluid ground state has long-ranged correlations resulting in a parabola-like distribution of bond dimensions. Meanwhile, the exponentially decaying correlations of the ground state Mott-insulator causes a flat distribution of bond dimensions, and the state is well represented using only very few eigenstates. Thus, the matrix product representation of the evolved state is very different from the ground state. However, when examining the entanglement and correlations following the exponential ramp in figure \ref{eq:CorrelationEvolution}, the high bond dimension seem redundant for the description of the state. Therefore, dynamically truncating the matrices at a low maximum bond dimension, $D$, should not alter the dynamics of the system considerably.

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.9\textwidth]{Figures/L20/FidelityTruncation.pdf}
    \caption{ \textbf{(a)} Obtained infidelity with regards to the Mott-insulating ground state for the exponential ramp. The calculation was carried out for different maximum bond dimension $D$. \textbf{(b)} Absolute difference between infidelities obtained with no truncation ($D = 1000$) and those employing a maximum bond dimension.  }
    \label{fig:FidelityTruncation}
\end{figure}
To prove that the bond dimension of the evolved state is artificially high, the same initial state was evolved according to the same exponential ramp while begin truncated at a given maximal bond dimension, $D$. The results shown in figure \ref{fig:FidelityTruncation} reveal that the obtained infidelity barely changes when decimating the bond dimension. While a weak scaling with maximum bond dimension was expected \cite{Daley2004}, the amount of redundant information in the $D = 1000$ evolution is still surprising. According to figure \ref{fig:FidelityTruncation}(b), choosing a maximal bond dimension of $D = 30$ should produce a difference in infidelity a magnitude smaller than the threshold for the quantum speed limit. Meanwhile, the time evolution of the truncated state should proceed much faster, as the application of the propagator scaled quadratically with the bond dimension.

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.9\textwidth]{Figures/L20/GradientTruncation.pdf}
    \caption{ \textbf{(a)} Gradient elements of the cost function \ref{eq:STcostgrad} for the exponential ramp. The calculation was carried out for different maximum bond dimension $D$. \textbf{(b)} Difference in gradient element between the non-truncated state ($D = 1000$) and the states having a maximum bond dimension. \textbf{(c)} Absolute value of the differences. }
    \label{fig:GradientTruncation}
\end{figure}
Lastly, it is also worth examining how the truncation affects the gradient elements, as having accurate derivatives is essential for a fast convergence rate \cite{deFouquieres2011}. Figure \ref{fig:GradientBondDim} shows the results of calculating the gradient elements \ref{eq:STcostgrad} for the exponential ramp without any regularization. Compared with the infidelity, the gradient scales more strongly with the maximum bond dimension. Therefore, the truncation is limited by the derivative of the cost function rather than the function itself. Unlike the infidelity, the gradient becomes gradually better during the ramp sequence. The same phenomenon is discussed in section \ref{sec:TrotterGrad} and is caused by the accumulated error when calculating $\ket{\chi (0)}$. 
While the bond dimensions of the matrix product state start growing rapidly after crossing the critical point, neither the infidelity nor the gradient show no signs of being influenced by the phase transition whatsoever. This discrepancy remains open for interpretation, however, it points towards optical control methods being well suited for studying phase transitions. 